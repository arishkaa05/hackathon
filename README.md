# Прототип интернет-магазина мерча LETI.

Разработанный с использованием Spring Framework, Hibernate, Spring Boot 3.1.5, Spring Security 6 и PostgreSQL, Mariadb,
Docker.

## Диаграмма базы данных

![Диаграмма базы данных](docs/diagram.png)

## Реализованы следующие страницы интернет-магазина:


- Главная страница
- Страница о нас
- Страница с товарами
- Страница с карточкой товара
- Корзина товаров
- Личный кабинет
- Категории
- Подкатегории
- Страница аутентификации/авторизации пользователя:

## Функциональность

Приложение предоставляет следующую функциональность:

- Главная страница:
    - Здесь пользователь может ознакомиться с информацией о магазине, его услугах и преимуществах.

- Страница о нас:
    - Здесь представлена информация о магазине, его истории, команде и целях.

- Страница с товарами:
    - Здесь пользователь может просмотреть список доступных товаров и их характеристики.
    - Имеется возможность добавить товар в корзину.

- Страница с карточкой товара:
    - Здесь представлена дополнительная информация о выбранном товаре, его изображение и возможность его добавить в
      корзину.

- Корзина товаров:
    - Здесь пользователь может просмотреть список добавленных в корзину товаров.
    - Имеется возможность изменить количество товаров и удалить товар из корзины.
    - При перезагрузке страницы товары, добавленные в корзину, сохраняются.

- Поиск по товарам:
    - Пользователь имеет возможность осуществлять поиск по названию товара или его характеристикам.

- Страница аутентификации/авторизации пользователя:
    - Разработан механизм регистрации с использование Spring Security -> реализована регистрация, авторизация(
      ROLE_USER,ROLE_ADMIN),аутентификация.

## Взятые за основу требования

- Спроектирована модель данных и схема БД на основе функционала интернет магазина. Отображена модель данных на uml
  диаграмме.
- Общение с серверной частью происходит через HTTP API, которое Stateless.
- Для авторизации/аутентификации использован JWT токен.
- Развертывание в Docker-контейнере.

## Архитектура REST API, HTTPS, Spring Boot MVC

Архитектура REST API приложения состоит из следующих компонентов:

- Клиентский слой:
    - Реализован на Vue 3.
    - Отвечает за визуальное представление данных и взаимодействие с пользователем.

- Серверный слой:
    - Реализован на Spring Boot.
    - Отвечает за обработку запросов от клиента и взаимодействие с базой данных.
    - Использует MVC архитектурный шаблон для разделения бизнес-логики, модели и представления.

- База данных:
    - Используется MariaDB или PostgreSQL для хранения информации о пользователях, товарах и заказах.

## Архитектурный шаблон MVC

![Архитектурный шаблон](api-seller-application/docs/mvc_spring.png) 

Модель (Model), представление (View) и контроллер (Controller).

Модель (Model) представляет собой компонент, который отвечает за обработку данных и бизнес-логику приложения. Он
содержит информацию и методы для работы с этой информацией. Модель не зависит от представления и контроллера, что
позволяет ей быть независимой и переиспользуемой.

Представление (View) отвечает за отображение данных модели пользователю. Оно представляет собой пользовательский
интерфейс, через который пользователь может взаимодействовать с приложением. Представление получает данные от модели и
отображает их пользователю. Оно не содержит бизнес-логики и не изменяет данные модели.

Контроллер (Controller) является посредником между моделью и представлением. Он получает запросы от пользователя через
представление, обрабатывает эти запросы, взаимодействует с моделью для получения или изменения данных и обновляет
представление с новыми данными. Контроллер также может выполнять дополнительные действия, такие как валидация данных или
управление навигацией.

## Пошаговое прохождение авторизации/аутентификации

![JWT](api-seller-application/docs/jwt.png)

## Устройство бекенд сервера с использованием послойного разделения бизнес логики

![layer](api-seller-application/docs/layer.png)

## Зависимости

Для запуска проекта необходимы следующие зависимости:

- Фронтенд:
    - Vue 3
    - JavaScript
- Бекенд
    - Java 17
    - Spring Framework
    - Hibernate
    - Spring Boot 3.1.5
    - Spring Security 6
    - PostgreSQL
    - Springdoc-openapi-starter-webmvc-ui 2.2.0
    - io.jsonwebtoken
    - Spring-boot-devtools
    - Lombok
    - Mapstruct

## Запуск проекта 

### Бекенд

Для запуска проекта выполните следующие шаги:

1. Клонирование репозитория: Склонируйте репозиторий проекта на свой локальный компьютер.

```
git clone https://gitlab.com/VladSemenovForVibeLab/merch-store -b backend
```

2. Перейдите в директорию проекта, где находится файл Dockerfile.

3. Соберите Docker контейнер:
    ```
    docker compose up
    ```
   так будет выглядить ваша консоль(находитесь в директории с Dockerfile):
   
  ![docker](api-seller-application/docs/docker_one.jpg)

  В Приложении Docker Engine вы сможете увидеть
  ![docker](api-seller-application/docs/docker_two.jpg)

  ![docker](api-seller-application/docs/docker_three.png)

![docker](api-seller-application/docs/docker_four.png)

4. Перейдите в браузере по адресу
    ```
    https://localhost:8082/swagger-ui/index.html#/ 
    ```
   для доступа к интернет-магазину - к полной реализации ручек-эндпоинтов.

Пожалуйста, обратите внимание, что в данном примере предполагается, что у вас уже установлен Docker. Также необходимо
убедиться, что порт 8082 свободен для использования.

### frontend

1. Клонирование репозитория: Склонируйте репозиторий проекта на свой локальный компьютер.

```
git clone https://gitlab.com/VladSemenovForVibeLab/merch-store -b new_branch
```

2. Перейдите в директорию проекта, где находится файл Dockerfile.

3. Соберите Docker образ с помощтю команды

```
docker build -t frontend .
```

![frontend](api-seller-application/docs/frontend_one.png)

4. Проверьте, собрался ли ваш образ: сделать это можно с помощью команды в консоли Ubuntu
```
docker images
```
- Проверять все это стоит при запущенном Docker

![frontend](api-seller-application/docs/frontend_two.png)

5. Запустите одиноко одно изображение с помощью команды:

```
docker run --rm --name frontend_v1 -p 5173:5173 -d frontend
```

- так выглядит данное действие

![frontend](api-seller-application/docs/frontend_three.png)

6. Теперь в Docker Engine можно посмотреть созданные контейнеры: 

![frontend](api-seller-application/docs/frontend_four.png)

7. Для остановки контейнера с консоли нужно выполнить данную команду

```
docker stop frontend_v1
```

- так это будет выглядить

![frontend](api-seller-application/docs/frontend_five.png)

### Дополнительно
- Можно запустить контейнер чтобы он запускался при включении системы автоматически
```
docker run --name frontend_v1 --restart=always -p 5173:5173 -d frontend
```
![frontend](api-seller-application/docs/frontend_six.png)

## Руководство по использованию
 Так выглядит начальный экран при запуске Docker контейнера и открытие страницы по адресу
```
https://localhost:8082/swagger-ui/index.html#/
```
![swagger](api-seller-application/docs/swagger_one.png)

Далее возможно для тестирования приложения зайти по пароли и почте администратора:
Для этого нажмите на кнопку 'Try it Out' и введите данные
```agsl
{
  "email": "admin@example.com",
  "password": "admin"
}
```
 Так это будет выглядить в Swagger OpenApi
 ![swagger](api-seller-application/docs/swagger_two.png)

Затем вы получите токен JWT - аутентификации и авторизации, который необходимо вставить по нажатии на кнопку 
```agsl
Authorize
```
Так выглядит данное всплывающее окно
![swagger](api-seller-application/docs/swagger_three.png)

Затем можно тестировать дальнейшие endpoints

Например 
### Получение всех новых продуктов в размере 10 штук
![swagger](api-seller-application/docs/swagger_four.png)

### Пример регистрации
![swagger](api-seller-application/docs/swagger_five.png)

![swagger](api-seller-application/docs/swagger_six.png)

### Пример аутентификации/авторизации
![swagger](api-seller-application/docs/swagger_seven.png)

![swagger](api-seller-application/docs/swagger_eight.png)

### Пример редактирования личного кабинета user

![swagger](api-seller-application/docs/swagger_nine.png)

![swagger](api-seller-application/docs/swagger_ten.png)

```agsl
Стоит заметить что ADMIN редактирует любой профиль, обычный пользователь же может редактировать лишь свой аккаунт
```

### Пример создания пользователя администратором

![swagger](api-seller-application/docs/swagger_eleven.png)

![swagger](api-seller-application/docs/swagger_twelve.png)

Функция может понадобиться для тестирования 

### Поиск пользователей в диапазоне времени создания

![swagger](api-seller-application/docs/swagger_thirteen.png)

![swagger](api-seller-application/docs/swagger_fourteen.png)

- Функционал реализован для администраторов

### Проверка роли пользователя 

![swagger](api-seller-application/docs/swagger_fifteen.png)

- Каждый пользователь вошедший в систему -> прошедший аутентификацию может проверять свою роль

### Поиск пользователя по userId

![swagger](api-seller-application/docs/swagger_sixteen.png)

- Данный функционал позволяет найти пользователя по id, при этом если ваша роль USER -> вы можете найти лишь себя, ADMIN -> любого пользователя

### Поиск всех пользователей

![swagger](api-seller-application/docs/swagger_seventeen.png)

- Данным функционал обладают пользователи с ролью ROLE_ADMIN.

### Поиск всех пользователей по ключевым словам с использованием пагинации

![swagger](api-seller-application/docs/swagger_eighteen.png)

- Данный функционал реализован для администраторов, можно найти пользователей по имени или города(данные можно расширить при необходимости)

### Удаление пользователя по id

- Данным функционалом может воспользоваться как обычный пользователь со своим аккаунтом, так и администратор
- Администратор может удалить любого пользователя
- Пользователь может удалить лишь свой аккаунт

![swagger](api-seller-application/docs/swagger_nineteen.png)

## Готовое задание

В рамках данного задания были разработаны основные функциональные компоненты магазина мерча ЛЭТИ, включая главную
страницу, страницу о нас, страницу с товарами, страницу с карточкой товара, корзину товаров и возможность их
редактирования, а также поиск по товарам. Также был реализован механизм регистрации, авторизации, аутентификации.

### Реализация 

- Главная страниц: На ней предоставлены Новинки в магазине и выбранные подкатегории
- В футаре страницы предоставлены все категории интернет магазина

![frontend](api-seller-application/docs/home_page.png)

- Страница Контакты - о нас: предоставлена почта, местоположение, телефон и координаты нахождения учреждения

![frontend](api-seller-application/docs/about_us_page.png)

- Часто задаваемы вопросы: то, что необходимо для реального интернет-магазина для предотвращения множества проблем с поддержкой

![frontend](api-seller-application/docs/FAQ_page.png)

- Страницы с товарами: были реализованы страницы по категориям - можно увидеть товары лежащие в категории(Вся одежда)
- Также и по подкатегориям(Только футболки)

![frontend](api-seller-application/docs/product_page_one.png)

- Страница с продуктами в подкатегории Свитшоты

![frontend](api-seller-application/docs/product_page_two.png)

- Страница с продуктами в категории Аксессуары

![frontend](api-seller-application/docs/product_page_three.png)

- Страница с карточкой товара: в ней представлено описание продукта, его цена, скидка и комментарии к нему, производится расчет средней оценки и скидки.
- Можно с данной страницы добавить товар как в корзину так и в избранное интернет магазина.

![frontend](api-seller-application/docs/card_product.png)

![frontend](api-seller-application/docs/card_product_two.png)

- Страница корзины с возможностью редакирования: добавления продуктов, увеличения их количества, уменьшения, удаления продукта из корзины

![frontend](api-seller-application/docs/cart_of_goods.png)

- Поиск по товарам осуществляется в шапке по описанию и названию продуктов

- Страница регистрации: регистрация как и все endpoints реализованы с помощтю фронтенда и бекенда, поэтому регистрация реализована с помощью Spring Security 6, JWT 

![frontend](api-seller-application/docs/registration_page.png)

- Страница аутентификации/авторизации 

![frontend](api-seller-application/docs/registration_page_two.png)
